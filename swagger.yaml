openapi: 3.0.0
info:
  title: DanceProgressTracker API
  description: Серверна частина системи відстеження прогресу в танцювальній школі
  version: 1.0.0

servers:
  - url: http://localhost:5000/api
    description: Локальний сервер

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

tags:
  - name: Auth
    description: Автентифікація та реєстрація
  - name: Groups
    description: Керування групами
  - name: Students
    description: Керування учнями
  - name: Admin
    description: Адміністрування, статистика та звіти

security:
  - bearerAuth: []

paths:
  /auth/register-admin:
    post:
      tags:
        - Auth
      summary: Реєстрація першого адміністратора
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                full_name:
                  type: string
                  example: Дмитро Макаров
                login:
                  type: string
                  example: admin
                password:
                  type: string
                  format: password
                  example: admin123
      responses:
        '201':
          description: Адміністратор створений

  /auth/login:
    post:
      tags:
        - Auth
      summary: Вхід в систему (отримання JWT)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                login:
                  type: string
                  example: admin2
                password:
                  type: string
                  format: password
                  example: admin123
      responses:
        '200':
          description: Токен видано

  /groups:
    post:
      tags:
        - Groups
      summary: Створити нову групу (адміністратор)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: Hip-Hop Початківці
                schedule:
                  type: array
                  items:
                    type: object
                    properties:
                      date:
                        type: string
                        example: "2025-05-12"
                      time:
                        type: string
                        example: "19:00"
      responses:
        '201':
          description: Група створена

    get:
      tags:
        - Groups
      summary: Отримати всі групи
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Список груп

  /students:
    post:
      tags:
        - Students
      summary: Додати нового учня (адміністратор)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                full_name:
                  type: string
                  example: Іван Петренко
                birth_date:
                  type: string
                  format: date
                  example: 2010-05-15
                phone:
                  type: string
                  example: +380991234567
                email:
                  type: string
                  example: ivan@example.com
                notes:
                  type: string
                  example: Початківець
      responses:
        '201':
          description: Учень створений

    get:
      tags:
        - Students
      summary: Отримати учнів (з фільтром по групі)
      security:
        - bearerAuth: []
      parameters:
        - name: groupId
          in: query
          schema:
            type: string
          description: ID групи для фільтрації
      responses:
        '200':
          description: Список учнів

  /students/enroll:
    post:
      tags:
        - Students
      summary: Записати учня до групи (адміністратор)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                student_id:
                  type: string
                  example: 694f0be789606d7456613446
                group_id:
                  type: string
                  example: 694f0bd389606d7456613444
      responses:
        '201':
          description: Учень записаний до групи

  /admin/teachers:
    post:
      tags:
        - Admin
      summary: Створити викладача (адміністратор)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                full_name:
                  type: string
                login:
                  type: string
                password:
                  type: string
      responses:
        '201':
          description: Викладач створений

  /admin/users/{id}:
    delete:
      tags:
        - Admin
      summary: Видалити користувача (адміністратор)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Користувач видалено

  /admin/groups/{id}:
    put:
      tags:
        - Admin
      summary: Редагувати групу (адміністратор)
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                schedule:
                  type: array
                  items:
                    type: object
                    properties:
                      date:
                        type: string
                        example: "2025-05-12"
                      time:
                        type: string
                        example: "19:00"
      responses:
        '200':
          description: Група оновлена

  /admin/statistics/{groupId}:
    get:
      tags:
        - Admin
      summary: Розрахунок статистики по групі
      security:
        - bearerAuth: []
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Статистика (пропуски, середній бал)

  /admin/reports:
    get:
      tags:
        - Admin
      summary: Генерація звіту
      security:
        - bearerAuth: []
      parameters:
        - name: groupId
          in: query
          schema:
            type: string
          description: ID групи (необов'язково)
        - name: period_start
          in: query
          schema:
            type: string
            format: date
        - name: period_end
          in: query
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Звіт згенеровано